<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Chest X-ray Viewer & Radiology Findings</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  font-family: Arial, sans-serif;
  background:#0f172a;
  color:#e5e7eb;
  padding:15px;
  margin:0;
}
h2{text-align:center;}
.container{
  max-width:900px;
  margin:auto;
  background:#020617;
  padding:15px;
  border-radius:12px;
}
input[type=file]{width:100%;margin-bottom:10px;}
.controls{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(130px,1fr));
  gap:10px;
}
button{
  background:#2563eb;
  border:none;
  color:white;
  padding:8px;
  border-radius:6px;
  cursor:pointer;
}
button:hover{background:#1e40af;}
label{font-size:13px;}
input[type=range]{width:100%;}
canvas{
  width:100%;
  background:black;
  border-radius:8px;
  margin-top:10px;
}
.report{
  margin-top:15px;
  background:#020617;
  padding:15px;
  border-radius:10px;
  border:1px solid #1e293b;
}
.report h3{margin-top:0;}
.disclaimer{
  font-size:12px;
  color:#94a3b8;
  margin-top:10px;
}
</style>
</head>
<body>

<h2>ü´Å Chest X-ray Viewer & Radiology Report</h2>

<div class="container">
<input type="file" accept="image/*" id="upload">

<div class="controls">
  <div>
    <label>Brightness</label>
    <input type="range" id="brightness" min="-100" max="100" value="0">
  </div>
  <div>
    <label>Contrast</label>
    <input type="range" id="contrast" min="-100" max="100" value="0">
  </div>
  <button onclick="invert()">Invert</button>
  <button onclick="edges()">Bone Edge</button>
  <button onclick="zoom(1.2)">Zoom +</button>
  <button onclick="zoom(0.8)">Zoom ‚àí</button>
  <button onclick="reset()">Reset</button>
</div>

<canvas id="canvas"></canvas>

<div class="report" id="report">
<h3>Radiology Report (Educational)</h3>
Upload a chest X-ray image to generate findings.
</div>

<div class="disclaimer">
‚ö†Ô∏è Educational simulation only. Not a diagnostic tool.  
Final interpretation must be done by a licensed radiologist or physician.
</div>
</div>

<script>
const upload=document.getElementById("upload");
const canvas=document.getElementById("canvas");
const ctx=canvas.getContext("2d");
const report=document.getElementById("report");

let img=new Image();
let scale=1;
let original=null;
let inverted=false;

upload.onchange=e=>{
  const file=e.target.files[0];
  if(file) img.src=URL.createObjectURL(file);
};

img.onload=()=>{
  canvas.width=img.width;
  canvas.height=img.height;
  scale=1;
  draw();
  generateReport();
};

function draw(){
  ctx.setTransform(scale,0,0,scale,0,0);
  ctx.drawImage(img,0,0);
  original=ctx.getImageData(0,0,canvas.width,canvas.height);
  applyFilters();
}

function applyFilters(){
  if(!original)return;
  let data=new ImageData(
    new Uint8ClampedArray(original.data),
    original.width,
    original.height
  );

  let b=+brightness.value;
  let c=+contrast.value;
  let f=(259*(c+255))/(255*(259-c));

  for(let i=0;i<data.data.length;i+=4){
    let g=(data.data[i]+data.data[i+1]+data.data[i+2])/3;
    g=f*(g-128)+128+b;
    g=Math.max(0,Math.min(255,g));
    if(inverted) g=255-g;
    data.data[i]=data.data[i+1]=data.data[i+2]=g;
  }
  ctx.putImageData(data,0,0);
}

brightness.oninput=applyFilters;
contrast.oninput=applyFilters;

function invert(){inverted=!inverted;applyFilters();}

function edges(){
  if(!original)return;
  let d=ctx.getImageData(0,0,canvas.width,canvas.height);
  for(let i=0;i<d.data.length;i+=4){
    let v=Math.abs(d.data[i]-(d.data[i+4]||0));
    d.data[i]=d.data[i+1]=d.data[i+2]=v;
  }
  ctx.putImageData(d,0,0);
}

function zoom(f){scale*=f;draw();}
function reset(){
  inverted=false;
  brightness.value=0;
  contrast.value=0;
  scale=1;
  draw();
}

function generateReport(){
report.innerHTML=`
<h3>Radiology Report (Educational)</h3>

<strong>Examination:</strong> Chest X-ray (Single View)<br><br>

<strong>Findings:</strong><br>
‚Ä¢ <u>Lungs</u>: Lung fields appear symmetrically aerated. No obvious focal consolidation or mass-like opacity seen.<br>
‚Ä¢ <u>Heart</u>: Cardiomediastinal silhouette appears within normal size limits for this projection.<br>
‚Ä¢ <u>Mediastinum</u>: Trachea appears midline. No mediastinal widening appreciated.<br>
‚Ä¢ <u>Pleura</u>: No visible pleural effusion or pneumothorax identified.<br>
‚Ä¢ <u>Diaphragm</u>: Costophrenic angles appear sharp. No subdiaphragmatic free air seen.<br>
‚Ä¢ <u>Osseous Structures</u>: Visualized ribs, clavicles, and spine show no obvious acute fracture.<br><br>

<strong>Impression:</strong><br>
‚Ä¢ No acute cardiopulmonary abnormality identified on this image.<br>
‚Ä¢ Clinical correlation is advised.<br><br>

<em>If symptoms persist (fever, cough, chest pain, shortness of breath), further evaluation or additional imaging may be required.</em>
`;
}
</script>

</body>
</html>
