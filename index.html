<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Advanced Chest X-ray Simulator</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  background:#020617;
  color:#e5e7eb;
  font-family:Arial,sans-serif;
  padding:15px;
}
h2{text-align:center;}
.container{
  max-width:1000px;
  margin:auto;
}
.controls{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(160px,1fr));
  gap:10px;
  margin-bottom:10px;
}
label{font-size:13px;}
select,input[type=range],button{
  width:100%;
}
button{
  background:#2563eb;
  color:#fff;
  border:none;
  padding:8px;
  border-radius:6px;
  cursor:pointer;
}
button:hover{background:#1e40af;}
canvas{
  width:100%;
  background:black;
  border-radius:8px;
}
.disclaimer{
  font-size:12px;
  color:#94a3b8;
  margin-top:10px;
}
</style>
</head>
<body>

<h2>ü©ª Advanced Chest X-ray Simulator</h2>

<div class="container">

<div class="controls">
  <div>
    <label>View</label>
    <select id="view">
      <option value="PA">PA View</option>
      <option value="AP">AP View</option>
    </select>
  </div>

  <div>
    <label>Patient Type</label>
    <select id="patient">
      <option value="adult">Adult</option>
      <option value="child">Pediatric</option>
    </select>
  </div>

  <div>
    <label>Condition</label>
    <select id="condition">
      <option value="normal">Normal</option>
      <option value="pneumonia">Pneumonia</option>
      <option value="tb">TB Cavitation</option>
      <option value="effusion">Pleural Effusion</option>
      <option value="pneumo">Pneumothorax</option>
      <option value="cardio">Cardiomegaly</option>
    </select>
  </div>

  <div>
    <label>Exposure (kVp)</label>
    <input type="range" id="kvp" min="60" max="120" value="90">
  </div>

  <button onclick="render()">Generate X-ray</button>
</div>

<canvas id="canvas" width="800" height="1000"></canvas>

<div class="disclaimer">
‚ö†Ô∏è Educational radiography simulator only.  
Not a diagnostic or medical device.
</div>

</div>

<script>
const canvas=document.getElementById("canvas");
const ctx=canvas.getContext("2d");

function render(){
  const kvp=document.getElementById("kvp").value;
  const condition=document.getElementById("condition").value;
  const patient=document.getElementById("patient").value;
  const view=document.getElementById("view").value;

  let img=ctx.createImageData(canvas.width,canvas.height);

  for(let y=0;y<canvas.height;y++){
    for(let x=0;x<canvas.width;x++){
      let i=(y*canvas.width+x)*4;

      let val=20; // air

      let lungSize = patient==="child"?180:230;
      let heartSize = patient==="child"?90:140;

      let lx=canvas.width*0.3;
      let rx=canvas.width*0.7;
      let ly=canvas.height*0.35;

      let dL=Math.hypot(x-lx,y-ly);
      let dR=Math.hypot(x-rx,y-ly);

      if(dL<lungSize||dR<lungSize) val=50;

      let dH=Math.hypot(x-canvas.width/2,y-canvas.height*0.45);
      if(dH<heartSize || (view==="AP" && dH<heartSize*1.2)) val=130;

      if(Math.abs(x-canvas.width/2)<10) val=200;
      if(y%85<3 && (x<canvas.width*0.4||x>canvas.width*0.6)) val=180;

      if(condition==="pneumonia" && x>canvas.width*0.55 && y>canvas.height*0.35 && y<canvas.height*0.6) val+=60;

      if(condition==="tb" && y<canvas.height*0.35 && x>canvas.width*0.55) val+=90;

      if(condition==="effusion" && y>canvas.height*0.65) val+=80;

      if(condition==="pneumo" && x<canvas.width*0.3) val=10;

      if(condition==="cardio" && dH<heartSize*1.4) val=160;

      val = val*(kvp/90) + Math.random()*10;
      val = Math.min(255,Math.max(0,val));

      img.data[i]=img.data[i+1]=img.data[i+2]=val;
      img.data[i+3]=255;
    }
  }

  ctx.putImageData(img,0,0);

  ctx.fillStyle="white";
  ctx.font="20px Arial";
  ctx.fillText("L",canvas.width-40,40);
  ctx.fillText("R",20,40);
}

render();
</script>

</body>
</html>
